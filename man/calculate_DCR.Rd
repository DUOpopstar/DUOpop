% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculate_dcr.R
\name{calculate_DCR}
\alias{calculate_DCR}
\title{Calculate Distance to Closest Record}
\usage{
calculate_DCR(
  original_df,
  synthetic_df,
  na.as.distance = TRUE,
  KR.corr = TRUE,
  rrd_quantile = 0.95,
  srd_threshold = 0.005,
  top_n_copies = 10,
  interactive_output = TRUE
)
}
\arguments{
\item{original_df}{A data frame containing the original data set.}

\item{synthetic_df}{A data frame containing the synthetic data set.}

\item{na.as.distance}{Logical; passed to \code{\link{custom_gower}} to determine how missing values (\code{NA}) are handled:
\describe{
\item{\code{FALSE}}{Standard Gower behavior: distances involving \code{NA} are excluded from averaging, effectively ignoring missing data.}
\item{\code{TRUE} (default)}{\code{NA} values contribute to the distance computation. Pairs with one missing value are assigned a distance of 1; pairs with both values missing are assigned a distance of 0, and these comparisons count in the average.}
}}

\item{KR.corr}{Logical; passed to \code{\link{custom_gower}} to specify whether
ordinal variables use Kaufman & Rousseeuw (1990) correction for scaling
(\code{TRUE}) or Gower's original method (\code{FALSE}).}

\item{rrd_quantile}{Numeric between 0 and 1; quantile threshold of RRD above which
records are considered potential outliers (default = 0.95).}

\item{srd_threshold}{Numeric; maximum SRD distance below which a record is considered
too closely copied in the synthetic data (default = 0.005).}

\item{top_n_copies}{Integer; number of top copied outliers (ranked by RRD) to display
in the \code{closest_matches} output (default = 10).}

\item{interactive_output}{Logical; if \code{TRUE} (default) results are shown interactively:
plots are displayed sequentially with pause prompts, and the table of closest matches is opened in a viewer.}
}
\value{
A list with:
\describe{
\item{histogram}{A ggplot2 histogram of \code{RRD - SRD}.}
\item{scatterplot}{A ggplot2 scatter plot of \code{SRD} vs. \code{RRD} per observation.}
\item{closest_matches}{A data frame with the \code{top_n_copies} copied outliers
and their closest matches.}
}
}
\description{
This function calculates Distance to Closest Record (DCR) metrics to
evaluate the similarity between an original data set and a synthetic data set.
Factor levels in both data sets are first harmonized using \code{\link{harmonize_factor_levels}}
to ensure comparability.
It then computes the distance measures per record using Gower distance:
\itemize{
\item \strong{RRD (Real-to-Real Distance):} the minimum distance from each original record to its closest neighbor in the original data set.
\item \strong{SRD (Synthetic-to-Real Distance):} the minimum distance from each original record to its closest neighbor in the synthetic data set.
}

Records flagged as 'copied_outlier' are those with a high RRD
(above a user-defined quantile) and a very low SRD (below a user-defined threshold), indicating they are
exactly or closely copied into the synthetic data set, and may reflect a
privacy risk.
}
\details{
\strong{DCR as a privacy metric:}
Distance to Closest Record (DCR) is often used to quantify disclosure risk in
synthetic data generation. It enables to (1) identify the most-at-risk records
in the original data set, and (2) ensure that those records are not exactly or
closely copied in the synthetic data set.
In particular, a high  RRD (Real-to-Real distance) indicates that a real record
has few similar neighbors in the original data set, meaning that if a close
synthetic match exists, it could reveal sensitive information about a unique
individual or outlier. This increases the risk of identification. To prevent this,
such records should not have a low SRD (Synthetic-to-Real distance), which
indicates that a synthetic record is nearly identical to a real record.
}
\examples{
# Example data
set.seed(123)
original <- data.frame(
  age = sample(20:70, 50, TRUE),
  gender = factor(sample(c("M", "F"), 50, TRUE))
)
synthetic <- original
synthetic$age <- synthetic$age + rnorm(50, 0, 5)

# Calculate Distance to Closest Record
res <- calculate_DCR(original, synthetic)
res2 <- calculate_DCR(original, synthetic, na.as.distance = FALSE, KR.corr = FALSE, rrd_quantile =  0.9, srd_threshold = 0.01, top_n_copies = 3, interactive_output = FALSE)

}
\seealso{
\code{\link[=custom_gower]{custom_gower()}}, \code{\link[=harmonize_factor_levels]{harmonize_factor_levels()}}
}
